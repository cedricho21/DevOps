

# D01-Linux

## Part 1. Установка ОС
---------
![](image/1.png)
* Вывод версии Ubuntu при помощи ***cat /etc/issue***

## Part 2. Создание пользователя
---------
![](image/2.1.png)
* Создание нового пользователя командой ***sudo adduser***

![](image/2.2.png)
* Добавление пользователя в группу adm

![](image/2.3.png)
* Вывод команды ***cat /etc/passwd*** 

## Part 3. Настройка сети ОС
---------
![](image/3.1.png)
* Задание названия машины вида user-1 при помощи ***sudo hostnamectl set-hostname user-1***

![](image/3.2.png)
* Установка временной зоны Новосибирска при помощи ***sudo timedatectl set-timezone Asia/Novosibirsk***

![](image/3.3.png)
* Вывод названий сетевых интерфейсов при помощи ***ls /sys/class/net***

* **lo** - интерфейс, который используется для отладки сетевых программ и запуска серверных приложений на локальной машине. Дополнительное средство в устранении проблем физического соединения.

![](image/3.4.png)
*  Получение ip-адреса устройства, на котором мы работаем, от DHCP сервера при помощи ***hostname -I***

* Dynamic Host Configuration Protocol (DHCP) — это протокол прикладного уровня, который помогает назначать IP-адреса устройствам при подключении к серверу. Протокол DHCP автоматизирует выдачу адресов, а также их передачу следующим пользователям после отключения устройств или их перехода из одной подсети в другую. Протокол динамического присвоения IP-адресов функционирует по принципу DORA.

![](image/3.5.1.png)
* Вывод на экран внешнего IP-адреса шлюза при помощи ***curl ifconfig.me***

![](image/3.5.2.png)
* Вывод на экран внутреннего IP-адреса шлюза при помощи ***ip route***

![](image/3.6.png)
* Внесение настроек ip, gw, dns вручную через команду ***sudo vim /etc/netplan/00-installer-config.yaml***
* Применяем изменения командой ***sudo netplan apply***

![](image/3.7.1.png) 
![](image/3.7.2.png)
* Убеждаемся, что статичные сетевые настройки сохранились после перезагрузки виртуальной машины

![](image/3.8.png)
* Успешно пингуем 1.1.1.1 и ya.ru по 4 раза

## Part 4. Обновление ОС
---------
* Обновление всех пакетов до последней версии делаем при помощи ***sudo apt-get upgrade***

![](image/4.png)
* При повторном вводе команды убеждаемся, что обновления отсутствуют

## Part 5. Использование команды sudo
---------
* **Команда sudo** предоставляет возможность пользователям выполнять команды от имени суперпользователя root, либо других пользователей. Правила, используемые sudo для принятия решения о предоставлении доступа, находятся в файле /etc/sudoers.

![](image/5.png)
* Добавление пользователя cedricho в группу sudo команой  ***sudo su*** и смена имени машины от его имени.

## Part 6. Установка и настройка службы времени
---------
![](image/6.png)
* Вывод timedatectl show, наличие NTPSynchronized=yes

## Part 7. Установка и использование текстовых редакторов
---------
![](image/7.1.png)
* Установка MCEDIT командой ***sudo apt-get install mcedit***

![](image/7.2.png)
* Файл test_vim.txt с cedricho.
* Выход с изменениями: Esc, :wq, Enter

![](image/7.3.png)
* Файл test_nano.txt с cedricho.
* Выход с изменениями: Ctrl+x, Y, Enter

![](image/7.4.png)
* Файл test_mcedit.txt с cedricho.
* Выход с изменениями: Esc, Yes, Enter

![](image/7.5.png)
* Файл test_vim.txt с изменениями.
* Выход без изменений: Esc, :q, Enter

![](image/7.6.png)
* Файл test_nano.txt с изменениями.
* Выход без изменений: ctrl+x, N

![](image/7.7.png)
* Файл test_mcedit.txt с изменениями.
* Выход без изменений: Esc, No, Enter

![](image/7.8.png)
* Результаты поиска в VIM.
* Поиск: нажать '/', ввести нужную строку. Совпадение выделяется.

![](image/7.9.png)
* Результат поиска в NANO.
* Поиск: ctrl + w, ввод нужной строки, enter. Курсор перемещается к началу совпадения, появляется информация о количестве совпадений.

![](image/7.10.png)
* Результаты поиска в MCEDIT.
* Поиск: F7, ввод нужной строки, нажать ok.

![](image/7.11.png)
* VIM с командой для замены слова на другое.
* Команда для замены: :s/cedricho/I_Love_Verter.

![](image/7.12.png)
![](image/7.13.png)
* NANO с командой для замены слова на другое.
* Замена: ctrl + \, ввод строки. Затем ввод новой строки. Yes

![](image/7.14.png)
* MCEDIT с командой для замены слова на другое.
* F4, ввод искомой строки, ввод замены. Далее нажать "Replace".

## Part 8. Установка и базовая настройка сервиса SSHD
---------
![](image/8.1.png)
* Установка SSHd командой ***sudo apt-get install openssh-server***

![](image/8.2.png)
* Включение автостарта службы командой ***sudo systemctl enable ssh***

* Перенастройка службы на порт 2022: 
* Открытия файла конфигурации командой ***vim /etc/ssh/sshd_config***
![](image/8.3.png)
* Строка Port 22 изменена на Port 2022

* Перезапуск службы командой ***sudo systemctl restart sshd***

![](image/8.4.png)
* Вывод наличия процесса sshd командой ***ps -aux | grep ssh***

* **Утилита 'ps'** - программа для определения работающих в системе программ и оценки используемых ими ресурсов. Она выводит статистику и информацию о состоянии процессов в системе, в том числе ИД процесса или нити, объем выполняемого ввода-вывода и используемый объем ресурсов процессора и памяти.

**Ключи команды** <u>ps</u>:
* -A, -e - выбор всех процессы
* -a - выбор всех процессов, кроме фоновых
* -d - выбор всех процессов, включая фоновые, кроме процессов сессий
* -N - выбор всех процессов, кроме указанных
* -C - выбор процессов по имени команды
* -G - выбор процессов по ID группы
* -p - выбор процессов PID
* --ppid - выбор процессов по PID родительского процесса
* -s - выбор процессов по ID сессии
* -t - выбор процессов по tty
* -u - выбор процессов пользователя
* -x - найти все вхождения строки поиска
* -c - отображение информации планировщика
* -f - вывод максимума доступных данных
* -F - выводит больше данных
* -l - длинный формат вывода
* -j - вывод процессов Jobs
* -M - добавить информацию о безопасности
* -o - позволяет определить свой формат вывода
* --sort - выполняет сортировку указанной колонки
* -L - отображать потоки процессов в колонках LWP и NLWP
* -m - вывести потоки после процесса
* -V - вывести информацию о версии
* -H - отображать дерево процессов

* Перезагрузка системы командой ***sudo reboot***

* Загрузка утилиты netstat командой ***sudo apt install net-tools***

![](image/8.5.png)
* Вывод команды netstat -tan

**Значение ключей -tan, значения каждого столбца, значение 0.0.0.0.**

* -t - отображает текущее подключение в состоянии переноса нагрузки с процессора на сетевой адаптер при передаче данных.
* -a - отображает все подключения и ожидающие порты.
* -n - отображает все адреса и номера портов в числовом формате.
* Proto - протокол, используемый сокетом. 
* Recv-Q - счётчик байт, не скопированных программой пользователя из этого сокета.
* Send-Q - счётчик байт, не подтверждённых удалённым узлом.
* Local Address - адрес и номер порта локального конца сокета.
* Foreign Address - адрес и номер порта удалённого конца сокета.
* State - Состояние сокета. LISTEN - Сокет ожидает входящих подключений. ESTABLISHED - Сокет находится в состянии установленного подключения.
* 0.0.0.0 означает «любой IP данного компьютера». Адрес 0.0.0.0 обычно означает, что IP адрес ещё не настроен или не присвоен. Адрес указывает хост, который обращается к DHCP для получения IP адреса.

## Part 9. Установка и использование утилит top, htop
---------
![](image/9.1.png)
* **Запуск и вывод команды top.**

![](image/9.2.png)
* Uptime - 11 минут.

![](image/9.3.png)
* Количество автовизированных пользователей.

![](image/9.4.png)
* Загрузка системы.

![](image/9.5.png)
* Количество всех процессов.

![](image/9.6.png)
* Загрузка cpu - 0.2%, они отведены под процессы ядра.

![](image/9.7.png)
* Загрузка памяти.

![](image/9.8.png)
* PID процесса, который занимает больше всего процессорного времени и памяти - 953.

**Запуск htop командой htop**

![](image/9.9.png)
* Вывод команды, отсортированный по PID.

![](image/9.10.png)
* Вывод команды, отсортированный по CPU.

![](image/9.11.png)
* Вывод команды, отсортированный по MEM.

![](image/9.12.png)
* Вывод команды, отсортированный по TIME.

![](image/9.13.png)
* Вывод с фильтром по процессу sshd.

![](image/9.14.png)
* Процесс syslog.

![](image/9.15.png)
* Добавлен вывод hostname, clock, uptime.

## Part 10. Использование утилиты fdisk
---------
* Вывод при помощи команды ***sudo fdisk -l***

![](image/10.png)
* Название - sda. Размер 16GB. Кол-во секторов - 33554432. Swap не создавался.

## Part 11. Использование утилиты df
---------

* Запуск командой ***sudo df.***

![](image/11.1.png)
* Корневой раздел - 16445308кб.
* Занятое пространство - 6693212кб.
* Свободное пространство - 8897008кб.
* Процент использования - 43%.


* Запуск командой ***sudo df -Th.***

![](image/11.2.png)
* Размер раздела - 16GB.
* Занятое пространство - 6.4GB.
* Свободное пространство - 8.5GB.
* Процент использования - 43%.
* Тип файловой системы для раздела - ext4.

## Part 12. Использование утилиты du
---------

![](image/12.1.png)
* Запуск командой ***sudo du***

![](image/12.2.png)
* Вывод размеров папок /home и /var командой ***sudo du -h -d 0 /home /var***
* Вывод размера папки log командой ***sudo du -h -d 0 /var/log***

![](image/12.3.png)
* Вывод всего содержимого /var/log командой ***sudo du -h -d 0 /var/log/* ***

## Part 13. Установка и использование утилиты ncdu
---------

![](image/13.1.png)
* Установка утилиты командой ***sudo apt install ncdu***

![](image/13.2.png)
* Вывод командой ***sudo ncdu /home***

![](image/13.3.png)
* Вывод командой ***sudo ncdu /var***

![](image/13.4.png)
* Вывод командой ***sudo ncdu var/log***

## Part 14. Работа с системными журналами
---------

![](image/14.1.png)
* Просмотр /var/log/dmesg командой ***less /var/log/dmesg***

![](image/14.2.png)
* Просмотр /var/log/syslog командой ***less /var/log/syslog***

![](image/14.3.png)
* Просмотр /var/log/auth.log командой ***less /var/log/auth.log***

![](image/14.4.png)
* Время последней успешной авторизации, имя пользователя и метод входа в систему. Команда ***sudo grep -ai LOGIN /var/log/auth.log***
* Время авторизации - 07:58, имя пользователя - cedricho, метод входа - login.

* Перезапуск службы SSHd командой ***sudo systemctl restart sshd.***

![](image/14.5.png)
*  Информация о рестарте sshd службы в логах "auth.log", команда: ***sudo grep -a restart /var/log/auth.log***

## Part 15. Использование планировщика заданий CRON

![](image/15.1.png)
* Создание задачи в cron.

![](image/15.2.png)
* uptime каждые 2 минуты.

![](image/15.3.png)
* Вывод списка задач.

![](image/15.4.png)
* Удаление всех задач и вывод нового списка.